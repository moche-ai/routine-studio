{
  "name": "Qwen Layered Edit",
  "description": "레이어 기반 이미지 편집 - 배경/전경 분리 및 개별 수정",
  "nodes": {
    "load_image": {
      "class_type": "LoadImage",
      "inputs": {}
    },
    "vae_loader": {
      "class_type": "VAELoader",
      "inputs": {
        "vae_name": "qwen_image_vae.safetensors"
      }
    },
    "unet_loader": {
      "class_type": "UNETLoader",
      "inputs": {
        "unet_name": "qwen_image_edit_2511_fp8mixed.safetensors",
        "weight_dtype": "default"
      }
    },
    "clip_loader": {
      "class_type": "DualCLIPLoader",
      "inputs": {
        "clip_name1": "qwen_2.5_vl_7b_fp8_scaled.safetensors",
        "clip_name2": "umt5_xxl_fp8_e4m3fn_scaled.safetensors",
        "type": "hunyuan_image"
      }
    },
    "layered_latent": {
      "class_type": "EmptyQwenImageLayeredLatentImage",
      "inputs": {
        "width": 1024,
        "height": 1024,
        "layers": 3,
        "batch_size": 1
      }
    },
    "text_encode": {
      "class_type": "TextEncodeQwenImageEditPlus",
      "inputs": {
        "prompt": "{{edit_instruction}}",
        "clip": ["clip_loader", 0],
        "vae": ["vae_loader", 0],
        "image1": ["load_image", 0]
      }
    },
    "sampler": {
      "class_type": "KSampler",
      "inputs": {
        "model": ["unet_loader", 0],
        "positive": ["text_encode", 0],
        "negative": ["text_encode", 0],
        "latent_image": ["layered_latent", 0],
        "seed": "{{seed}}",
        "steps": 30,
        "cfg": 5.0,
        "sampler_name": "euler",
        "scheduler": "normal",
        "denoise": 1.0
      }
    },
    "vae_decode": {
      "class_type": "VAEDecode",
      "inputs": {
        "samples": ["sampler", 0],
        "vae": ["vae_loader", 0]
      }
    },
    "save_image": {
      "class_type": "SaveImage",
      "inputs": {
        "images": ["vae_decode", 0],
        "filename_prefix": "qwen_layered"
      }
    }
  },
  "parameters": {
    "edit_instruction": {
      "type": "string",
      "required": true,
      "description": "레이어 편집 지시 (예: remove background, separate foreground)"
    },
    "seed": {
      "type": "int", 
      "default": -1
    },
    "layers": {
      "type": "int",
      "default": 3,
      "description": "레이어 수 (2=전경/배경, 3=전경/중경/배경)"
    }
  }
}
